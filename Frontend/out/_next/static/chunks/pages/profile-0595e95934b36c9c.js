(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{1920:(e,r,s)=>{"use strict";s.d(r,{A:()=>i});var t=s(7876),a=s(8230),o=s.n(a),l=s(9853);function i(){let{user:e,logout:r}=(0,l.J)();return(0,t.jsxs)("header",{className:"relative bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-600 shadow-xl",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/10 backdrop-blur-sm"}),(0,t.jsx)("div",{className:"relative max-w-7xl mx-auto px-6 py-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(o(),{href:"/",className:"group flex items-center space-x-3 transition-all duration-300 hover:scale-105",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center group-hover:bg-white/30 transition-all duration-300 backdrop-blur-md border border-white/30",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-white group-hover:text-blue-100 transition-colors duration-300",children:"Expense Tracker"})]}),(0,t.jsxs)("nav",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o(),{href:"/",className:"px-4 py-2 text-white/90 hover:text-white hover:bg-white/20 rounded-lg transition-all duration-300 font-medium backdrop-blur-sm border border-transparent hover:border-white/30 hover:shadow-lg",children:"Home"}),(0,t.jsx)(o(),{href:"/dashboard",className:"px-4 py-2 text-white/90 hover:text-white hover:bg-white/20 rounded-lg transition-all duration-300 font-medium backdrop-blur-sm border border-transparent hover:border-white/30 hover:shadow-lg",children:"Dashboard"}),e?(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)("div",{className:"hidden md:flex items-center px-3 py-2 bg-white/10 rounded-lg backdrop-blur-md border border-white/20",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"}),(0,t.jsxs)("span",{className:"text-sm text-white/90",children:["Welcome, ",(0,t.jsx)("span",{className:"font-semibold text-white",children:e.email.split("@")[0]})]})]}),(0,t.jsx)(o(),{href:"/profile",className:"px-4 py-2 text-white/90 hover:text-white hover:bg-white/20 rounded-lg transition-all duration-300 font-medium backdrop-blur-sm border border-transparent hover:border-white/30 hover:shadow-lg",children:"Profile"}),(0,t.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg transition-all duration-300 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 border border-red-400/30",children:"Logout"})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o(),{href:"/login",className:"px-4 py-2 text-white/90 hover:text-white hover:bg-white/20 rounded-lg transition-all duration-300 font-medium backdrop-blur-sm border border-transparent hover:border-white/30 hover:shadow-lg",children:"Login"}),(0,t.jsx)(o(),{href:"/signup",className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white rounded-lg transition-all duration-300 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 border border-emerald-400/30",children:"Sign Up"})]})]})]})}),(0,t.jsx)("div",{className:"h-1 bg-gradient-to-r from-transparent via-white/30 to-transparent"})]})}},3086:(e,r,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return s(9253)}])},9253:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>c});var t=s(7876),a=s(4232),o=s(6755),l=s(9853),i=s(6848),n=s(1920),d=s(9038);function c(){let{user:e,updateUser:r}=(0,l.J)(),[s,c]=(0,a.useState)({name:"",email:"",dob:"",phone:"",location:"",bio:""}),[m,h]=(0,a.useState)(!1),[x,u]=(0,a.useState)(!1),[b,g]=(0,a.useState)(!0),[p,f]=(0,a.useState)(null),[v,j]=(0,a.useState)("info"),w=()=>{console.log("=== DEBUG STORAGE ==="),console.log("localStorage user:",localStorage.getItem("user")),console.log("Context user:",e),console.log("Form state:",s),console.log("==================")},N=async()=>{try{console.log("Fetching user profile from API...");let e=(await o.A.get("/auth/me")).data;console.log("API Response:",e),r&&(r(e),console.log("Updated user context"));let s={name:e.name||"",email:e.email||"",dob:e.dob?e.dob.slice(0,10):"",phone:e.phone||"",location:e.location||"",bio:e.bio||""};c(s),console.log("Updated form state:",s)}catch(e){console.error("Error fetching user profile:",e),j("error"),f("Failed to load profile data")}finally{g(!1)}};(0,a.useEffect)(()=>{N()},[]),(0,a.useEffect)(()=>{e&&(console.log("User context changed, updating form..."),c({name:e.name||"",email:e.email||"",dob:e.dob?e.dob.slice(0,10):"",phone:e.phone||"",location:e.location||"",bio:e.bio||""}))},[e]);let y=(e,r)=>{c(s=>({...s,[e]:r}))},k=async()=>{if(f(null),!s.name.trim()){j("error"),f("Name is required.");return}if(s.phone&&!/^[\d+\-()\s]{6,20}$/.test(s.phone)){j("error"),f("Please enter a valid phone number.");return}u(!0);try{let e={name:s.name.trim(),dob:s.dob||void 0,phone:s.phone.trim()||void 0,location:s.location.trim()||void 0,bio:s.bio.trim()||void 0};console.log("=== SAVE ATTEMPT ==="),console.log("Payload being sent:",e);let t=await o.A.put("/auth/me",e);console.log("API Response:",t.data);let a=t.data.user||t.data;console.log("Updated user data:",a),r&&a&&(r(a),console.log("User context updated successfully")),c({name:a.name||"",email:a.email||"",dob:a.dob?a.dob.slice(0,10):"",phone:a.phone||"",location:a.location||"",bio:a.bio||""}),console.log("Form updated with response data"),setTimeout(()=>{w()},100),j("success"),f("Profile updated successfully! Changes will persist across sessions."),h(!1)}catch(s){var e,t,a,l,i;console.error("Profile update error:",s),console.error("Error response:",null==(e=s.response)?void 0:e.data);let r=(null==s||null==(a=s.response)||null==(t=a.data)?void 0:t.message)||(null==s||null==(i=s.response)||null==(l=i.data)?void 0:l.msg)||"Update failed. Please try again.";j("error"),f(r)}finally{u(!1),setTimeout(()=>f(null),5e3)}},C=()=>{g(!0),N()};if(b)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.A,{}),(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading profile..."})]})})]});if(!e)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.A,{}),(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.BS8,{className:"text-6xl text-red-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Unable to load profile data."}),(0,t.jsxs)("button",{onClick:C,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center mx-auto",children:[(0,t.jsx)(d.DIg,{className:"mr-2"}),"Retry"]})]})})]});let P=(s.name||"U").split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.A,{}),(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 py-8",children:(0,t.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-4xl mx-auto px-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 p-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsx)(i.P.div,{whileHover:{scale:1.05},className:"w-24 h-24 rounded-full bg-white/20 flex items-center justify-center text-3xl font-bold text-white",children:P}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:s.name||"User"}),(0,t.jsxs)("p",{className:"text-indigo-100 flex items-center",children:[(0,t.jsx)(d.maD,{className:"mr-2"}),s.email]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:w,className:"bg-white/10 hover:bg-white/20 text-white text-sm px-3 py-2 rounded-lg transition-all",title:"Debug Storage (remove in production)",children:"Debug"}),(0,t.jsx)("button",{onClick:C,className:"bg-white/10 hover:bg-white/20 text-white px-3 py-2 rounded-lg transition-all flex items-center",title:"Refresh Profile Data",children:(0,t.jsx)(d.DIg,{})}),m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:k,disabled:x,className:"bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition-all flex items-center disabled:opacity-50",children:[x?(0,t.jsx)(d.hW,{className:"animate-spin mr-2"}):(0,t.jsx)(d.dIn,{className:"mr-2"}),x?"Saving...":"Save"]}),(0,t.jsxs)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{e&&c({name:e.name||"",email:e.email||"",dob:e.dob?e.dob.slice(0,10):"",phone:e.phone||"",location:e.location||"",bio:e.bio||""}),f(null),h(!1)},className:"bg-white/20 hover:bg-white/30 border border-white/30 text-white font-semibold py-3 px-6 rounded-lg transition-all flex items-center",children:[(0,t.jsx)(d.QCr,{className:"mr-2"}),"Cancel"]})]}):(0,t.jsxs)(i.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>h(!0),className:"bg-white/20 hover:bg-white/30 backdrop-blur-sm border border-white/30 text-white font-semibold py-3 px-6 rounded-lg transition-all flex items-center",children:[(0,t.jsx)(d.uO9,{className:"mr-2"}),"Edit Profile"]})]})]})}),(0,t.jsxs)("div",{className:"p-8",children:[p&&(0,t.jsxs)(i.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-lg flex items-center ".concat("success"===v?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"),children:["success"===v?(0,t.jsx)(d.A7C,{className:"mr-3"}):(0,t.jsx)(d.BS8,{className:"mr-3"}),p]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(d.x$1,{className:"inline mr-2"}),"Full Name *"]}),(0,t.jsx)("input",{value:s.name,onChange:e=>y("name",e.target.value),disabled:!m,required:!0,className:"w-full px-4 py-3 border border-gray-200 rounded-lg transition-all ".concat(m?"focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-gray-50 cursor-not-allowed"),placeholder:"Enter your full name"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(d.maD,{className:"inline mr-2"}),"Email Address"]}),(0,t.jsx)("input",{readOnly:!0,value:s.email,className:"w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 cursor-not-allowed",title:"Email cannot be changed"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email address cannot be changed"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(d.bfZ,{className:"inline mr-2"}),"Date of Birth"]}),(0,t.jsx)("input",{type:"date",value:s.dob,onChange:e=>y("dob",e.target.value),disabled:!m,className:"w-full px-4 py-3 border border-gray-200 rounded-lg transition-all ".concat(m?"focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-gray-50 cursor-not-allowed")})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(d.Cab,{className:"inline mr-2"}),"Phone Number"]}),(0,t.jsx)("input",{value:s.phone,onChange:e=>y("phone",e.target.value),disabled:!m,placeholder:"e.g. +91 98765 43210",className:"w-full px-4 py-3 border border-gray-200 rounded-lg transition-all ".concat(m?"focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-gray-50 cursor-not-allowed")})]}),(0,t.jsxs)("div",{className:"md:col-span-1",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,t.jsx)(d.vq8,{className:"inline mr-2"}),"Location"]}),(0,t.jsx)("input",{value:s.location,onChange:e=>y("location",e.target.value),disabled:!m,placeholder:"City, Country",className:"w-full px-4 py-3 border border-gray-200 rounded-lg transition-all ".concat(m?"focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-gray-50 cursor-not-allowed")})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),(0,t.jsx)("textarea",{value:s.bio,onChange:e=>y("bio",e.target.value),disabled:!m,rows:4,placeholder:"Tell us about yourself...",className:"w-full px-4 py-3 border border-gray-200 rounded-lg transition-all resize-none ".concat(m?"focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-gray-50 cursor-not-allowed")})]})]}),(0,t.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,t.jsx)("strong",{children:"User ID:"})," ",e._id]}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"* Required fields"})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:["Last updated: ",e.updatedAt?new Date(e.updatedAt).toLocaleString():"Unknown"]})})]})})]})]})})})]})}}},e=>{e.O(0,[938,693,230,636,593,792],()=>e(e.s=3086)),_N_E=e.O()}]);