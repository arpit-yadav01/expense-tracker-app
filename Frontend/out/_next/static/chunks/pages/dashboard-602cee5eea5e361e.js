(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{4799:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var s=a(7876),r=a(4232),l=a(6848),n=a(2120),i=a(1920),o=a(6755),c=a(9099),d=a(9038);let x=a(1040).A.create({baseURL:"http://localhost:5001"});function m(e){let{expenses:t}=e,[a,n]=(0,r.useState)([]),[i,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!t||0===t.length)return;let e=Array.isArray(t)?t.filter(e=>e&&"number"==typeof e.amount&&e.category&&e.date):[];(async()=>{try{o(!0);let t=await x.post("/suggestions",{expenses:e});n(t.data.suggestions||[])}catch(e){console.error("Failed to fetch suggestions:",e)}finally{o(!1)}})()},[t]),(0,s.jsxs)(l.P.div,{className:"bg-white rounded-xl shadow-lg p-6 mt-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center mb-4",children:[(0,s.jsx)(d.ZPX,{className:"text-yellow-500 mr-2"}),"Smart Suggestions"]}),i?(0,s.jsx)("p",{className:"text-gray-500",children:"Analyzing your expenses..."}):0===a.length?(0,s.jsx)("p",{className:"text-gray-500",children:"No suggestions yet. Add some expenses."}):(0,s.jsx)("ul",{className:"space-y-2",children:a.map((e,t)=>(0,s.jsx)("li",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-md text-gray-800",children:e},t))})]})}function g(e){let{reports:t}=e;return t&&0!==t.length?(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow p-6 my-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Monthly Reports"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full table-auto border border-gray-200 rounded-lg",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsx)("tr",{children:Object.keys(t[0]).map(e=>(0,s.jsx)("th",{className:"px-4 py-2 border text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:e},e))})}),(0,s.jsx)("tbody",{children:t.map((e,t)=>(0,s.jsx)("tr",{className:"hover:bg-gray-50 transition-all",children:Object.values(e).map((e,t)=>(0,s.jsx)("td",{className:"px-4 py-2 border",children:e},t))},t))})]})})]}):(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow p-6 my-6 text-center",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Monthly Reports"}),(0,s.jsx)("p",{className:"text-gray-500",children:"No reports available."})]})}function h(e){let{month:t,onSaved:a}=e,[l,n]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),d=async()=>{if(!l||!i)return alert("Enter category and limit");try{await o.A.post("/budgets",{month:t,category:l,limit:Number(i)}),n(""),c(""),a()}catch(e){console.error(e),alert("Failed to save budget")}};return(0,s.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-xl shadow-md space-y-3",children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"Set Monthly Budget"}),(0,s.jsx)("input",{className:"input w-full",placeholder:"Category",value:l,onChange:e=>n(e.target.value)}),(0,s.jsx)("input",{className:"input w-full",type:"number",placeholder:"Limit (₹)",value:i,onChange:e=>c(e.target.value)}),(0,s.jsx)("button",{onClick:d,className:"btn bg-indigo-600 text-white w-full hover:bg-indigo-700 transition-all",children:"Save Budget"})]})}function u(e){let{month:t}=e,[a,l]=(0,r.useState)([]),n=async()=>{try{let e=await o.A.get("/budgets/".concat(t)),a=(await o.A.get("/expenses")).data.filter(e=>e.date.slice(0,7)===t),s=e.data.map(e=>{let t=a.filter(t=>t.category===e.category).reduce((e,t)=>e+t.amount,0),s=t/e.limit*100;return{...e,spent:t,percent:s,warning:s>=80,exceeded:s>=100}});l(s)}catch(e){console.error(e)}};return(0,r.useEffect)(()=>{n()},[t]),(0,s.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-lg text-white ".concat(e.exceeded?"bg-red-600":e.warning?"bg-yellow-500":"bg-green-500"),children:[e.category,": Spent ₹",e.spent," / ₹",e.limit," (",e.percent.toFixed(1),"%)"]},e.category))})}let p={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},y={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},f=e=>{let{title:t,value:a,icon:r,color:n,subtitle:i}=e;return(0,s.jsxs)(l.P.div,{variants:y,whileHover:{scale:1.02,y:-2},className:"relative overflow-hidden rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 ".concat(n),children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),(0,s.jsx)("div",{className:"relative p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium opacity-80 uppercase tracking-wide",children:t}),(0,s.jsx)("p",{className:"text-2xl font-bold mt-1",children:a}),i&&(0,s.jsx)("p",{className:"text-sm opacity-70 mt-1",children:i})]}),(0,s.jsx)(r,{className:"text-2xl opacity-60"})]})})]})},b=e=>{let{filters:t,onFilterChange:a,expenses:r,isVisible:n,onToggle:i}=e;return(0,s.jsx)(l.P.div,{initial:!1,animate:{height:n?"auto":0,opacity:+!!n},transition:{duration:.3},className:"overflow-hidden bg-white rounded-xl shadow-lg",children:(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.KSO,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search in notes...",value:t.search,onChange:e=>a("search",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.bfZ,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"date",value:t.from,onChange:e=>a("from",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.bfZ,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"date",value:t.to,onChange:e=>a("to",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("select",{value:t.category,onChange:e=>a("category",e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),[...new Set(r.map(e=>e.category))].map((e,t)=>(0,s.jsx)("option",{value:e,children:e},t))]}),(0,s.jsxs)("select",{value:t.paymentMethod,onChange:e=>a("paymentMethod",e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"",children:"All Payment Methods"}),[...new Set(r.map(e=>e.paymentMethod))].map((e,t)=>(0,s.jsx)("option",{value:e,children:e},t))]})]})]})})},j=e=>{let{expense:t,isEditing:a,editForm:r,onEdit:n,onSave:i,onCancel:o,onDelete:c,onFormChange:x}=e;return(0,s.jsxs)(l.P.tr,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},whileHover:{backgroundColor:"#f8fafc"},className:"border-b border-gray-100 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d.bfZ,{className:"text-gray-400 mr-2"}),new Date(t.date).toLocaleDateString("en-IN")]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:a?(0,s.jsx)("input",{value:r.category,onChange:e=>x("category",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}):(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800",children:t.category})}),(0,s.jsx)("td",{className:"px-6 py-4",children:a?(0,s.jsx)("input",{value:r.paymentMethod,onChange:e=>x("paymentMethod",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}):(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d.x1c,{className:"text-gray-400 mr-2"}),t.paymentMethod]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:a?(0,s.jsx)("input",{type:"number",value:r.amount,onChange:e=>x("amount",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}):(0,s.jsxs)("div",{className:"flex items-center font-semibold text-gray-900",children:[(0,s.jsx)(d.gPb,{className:"text-green-500 mr-1"}),t.amount.toLocaleString("en-IN")]})}),(0,s.jsx)("td",{className:"px-6 py-4 max-w-xs",children:a?(0,s.jsx)("textarea",{value:r.notes,onChange:e=>x("notes",e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",rows:"2"}):(0,s.jsx)("p",{className:"text-gray-600 truncate",title:t.notes,children:t.notes})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"flex items-center space-x-2",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:i,className:"flex items-center px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded-md text-sm transition-colors",children:[(0,s.jsx)(d.dIn,{className:"mr-1"}),"Save"]}),(0,s.jsxs)(l.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:o,className:"flex items-center px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white rounded-md text-sm transition-colors",children:[(0,s.jsx)(d.QCr,{className:"mr-1"}),"Cancel"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,className:"flex items-center px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-md text-sm transition-colors",children:(0,s.jsx)(d.uO9,{})}),(0,s.jsx)(l.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:c,className:"flex items-center px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded-md text-sm transition-colors",children:(0,s.jsx)(d.qbC,{})})]})})})]})};function N(){let e=(0,c.useRouter)(),[t,a]=(0,r.useState)([]),[x,N]=(0,r.useState)([]),[v,w]=(0,r.useState)({total:0,topCategory:null,topPayments:[]}),[C,S]=(0,r.useState)({category:"",paymentMethod:"",from:"",to:"",search:""}),[P,k]=(0,r.useState)(null),[A,E]=(0,r.useState)({}),[M,_]=(0,r.useState)(!1),[F,D]=(0,r.useState)(!0),O=new Date().toISOString().slice(0,7),[T,H]=(0,r.useState)(0),[L,I]=(0,r.useState)([]),R=async()=>{try{D(!0);let e=await o.A.get("/expenses");a(e.data),N(e.data),B(e.data)}catch(a){var t;console.error(a),(null==(t=a.response)?void 0:t.status)===401&&e.push("/login")}finally{D(!1)}};(0,r.useEffect)(()=>{fetch("http://127.0.0.1:5001/reports/USER_ID_HERE").then(async e=>{if(!e.ok){let t=await e.text();try{let e=JSON.parse(t);throw Error(e.error||e.detail||"Failed to fetch reports")}catch(e){throw Error("Reports endpoint not found (404)")}}return e.json()}).then(e=>I(e)).catch(e=>{console.error("Failed to load reports:",e)})},[]);let B=e=>{let t=e.filter(e=>e.date.slice(0,7)===O),a=t.reduce((e,t)=>e+t.amount,0),s={},r={};t.forEach(e=>{s[e.category]=(s[e.category]||0)+e.amount,r[e.paymentMethod]=(r[e.paymentMethod]||0)+1});let l=Object.entries(s).sort((e,t)=>t[1]-e[1])[0],n=Object.entries(r).sort((e,t)=>t[1]-e[1]).slice(0,3).map(e=>e[0]);w({total:a,topCategory:l?l[0]:"No expenses yet",topPayments:n})};(0,r.useEffect)(()=>{R()},[]),(0,r.useEffect)(()=>{let e;e=[...t],C.category&&(e=e.filter(e=>e.category===C.category)),C.paymentMethod&&(e=e.filter(e=>e.paymentMethod===C.paymentMethod)),C.from&&C.to&&(e=e.filter(e=>new Date(e.date)>=new Date(C.from)&&new Date(e.date)<=new Date(C.to))),C.search&&(e=e.filter(e=>e.notes.toLowerCase().includes(C.search.toLowerCase())||e.category.toLowerCase().includes(C.search.toLowerCase()))),N(e),B(e)},[C,t]);let Z=async e=>{try{await o.A.put("/expenses/".concat(e),{...A,amount:Number(A.amount)}),k(null),E({}),R()}catch(e){console.error(e),alert("Failed to update expense")}},X=()=>{k(null),E({})},q=async e=>{if(confirm("Are you sure you want to delete this expense?"))try{await o.A.delete("/expenses/".concat(e)),R()}catch(e){console.error(e),alert("Failed to delete expense")}},z=(e,t)=>{E(a=>({...a,[e]:t}))};return F?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})})})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50",children:(0,s.jsxs)(l.P.main,{variants:p,initial:"hidden",animate:"visible",className:"max-w-7xl mx-auto p-6 space-y-8",children:[(0,s.jsxs)(l.P.div,{variants:y,className:"text-center py-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Expense Dashboard"}),(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"Track and manage your expenses efficiently"})]}),(0,s.jsxs)(l.P.div,{variants:y,className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)(f,{title:"Total This Month",value:"₹".concat(v.total.toLocaleString("en-IN")),icon:d.gPb,color:"bg-gradient-to-br from-indigo-500 to-purple-600 text-white",subtitle:"".concat(new Date().toLocaleString("en-IN",{month:"long",year:"numeric"}))}),(0,s.jsx)(f,{title:"Top Category",value:v.topCategory,icon:d.qvi,color:"bg-gradient-to-br from-green-500 to-emerald-600 text-white"}),(0,s.jsx)(f,{title:"Payment Methods",value:"".concat(v.topPayments.length," Active"),icon:d.x1c,color:"bg-gradient-to-br from-orange-500 to-red-600 text-white",subtitle:v.topPayments.slice(0,2).join(", ")})]}),(0,s.jsxs)(l.P.div,{variants:y,className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(d.OiG,{className:"mr-2 text-indigo-600"}),"Set Budget"]}),(0,s.jsx)(h,{month:O,onSaved:()=>H(e=>e+1)})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Budget Alerts"}),(0,s.jsx)(u,{month:O},T)]})})]}),(0,s.jsxs)(l.P.div,{variants:y,className:"flex justify-between items-center",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["Expenses (",x.length,")"]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)(l.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>_(!M),className:"flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[(0,s.jsx)(d.YsJ,{className:"mr-2"}),M?"Hide Filters":"Show Filters"]}),Object.values(C).some(e=>e)&&(0,s.jsx)(l.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{S({category:"",paymentMethod:"",from:"",to:"",search:""})},className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition-colors",children:"Clear Filters"})]})]}),(0,s.jsx)(b,{filters:C,onFilterChange:(e,t)=>{S(a=>({...a,[e]:t}))},expenses:t,isVisible:M}),(0,s.jsx)(m,{expenses:t}),(0,s.jsx)(g,{reports:L}),(0,s.jsx)(l.P.div,{variants:y,className:"bg-white rounded-xl shadow-lg overflow-hidden",children:0===x.length?(0,s.jsxs)("div",{className:"p-12 text-center",children:[(0,s.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDCCA"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No expenses found"}),(0,s.jsx)("p",{className:"text-gray-500",children:Object.values(C).some(e=>e)?"Try adjusting your filters":"Start by adding your first expense"})]}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:"Date"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:"Category"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:"Payment"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:"Amount"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:"Notes"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:(0,s.jsx)(n.N,{children:x.map(e=>(0,s.jsx)(j,{expense:e,isEditing:P===e._id,editForm:A,onEdit:()=>{k(e._id),E({...e,amount:e.amount.toString(),date:e.date.slice(0,10)})},onSave:()=>Z(e._id),onCancel:X,onDelete:()=>q(e._id),onFormChange:z},e._id))})})]})})})]})})]})}},5372:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(4799)}])}},e=>{e.O(0,[938,693,230,299,636,593,792],()=>e(e.s=5372)),_N_E=e.O()}]);